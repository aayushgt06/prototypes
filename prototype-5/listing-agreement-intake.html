<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Listing Agreement Intake</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="../shared/components/Sidenav.js"></script>
</head>
<body class="bg-gray-100 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const ArrowLeft = ({ size = 20 }) => (
      <svg
        width={size}
        height={size}
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        strokeWidth={2}
        strokeLinecap="round"
        strokeLinejoin="round"
      >
        <path d="M19 12H5" />
        <path d="M12 19l-7-7 7-7" />
      </svg>
    );

    const PlusIcon = ({ size = 16 }) => (
      <svg
        width={size}
        height={size}
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        strokeWidth={2}
        strokeLinecap="round"
        strokeLinejoin="round"
      >
        <path d="M12 5v14" />
        <path d="M5 12h14" />
      </svg>
    );

    const UploadIcon = ({ size = 16 }) => (
      <svg
        width={size}
        height={size}
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        strokeWidth={2}
        strokeLinecap="round"
        strokeLinejoin="round"
      >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <polyline points="17 8 12 3 7 8" />
        <line x1="12" y1="3" x2="12" y2="15" />
      </svg>
    );

    function App() {
      const handleBackClick = () => {
        alert('Back button clicked - would navigate to previous page');
      };

      const handleSkipClick = () => {
        alert('Skip button clicked - would move to next workflow step');
      };

      return (
        <>
          <Sidenav
            activeItem="Transactions"
            notificationCount={4}
            userName="John Doe"
            userRole="Agent"
            userInitials="JD"
          />
          <div style={{ marginLeft: '256px' }}>
            <div
              className="fixed top-0 bg-white border-b border-gray-200"
              style={{ left: '256px', right: 0, height: '64px', zIndex: 40 }}
            >
              <div className="flex items-center justify-between h-full px-8">
                <div className="flex items-center gap-3">
                  <button
                    onClick={handleBackClick}
                    className="flex items-center justify-center w-10 h-10 rounded-lg hover:bg-gray-100 transition-colors text-gray-700"
                    aria-label="Go back"
                  >
                    <ArrowLeft size={20} />
                  </button>
                  <h1 className="text-xl font-semibold text-gray-900">
                    Listing Agreement Intake
                  </h1>
                </div>
                <button
                  onClick={handleSkipClick}
                  className="px-4 py-2 text-sm font-medium text-blue-600 rounded-lg hover:bg-blue-50 transition-colors"
                >
                  Skip Intake Form
                </button>
              </div>
            </div>

            <div style={{ paddingTop: '96px' }}>
              <ListingAgreementForm />
            </div>
          </div>
        </>
      );
    }

    function ListingAgreementForm() {
      const [formData, setFormData] = useState({
        listingAgreementStatus: 'no',
        propertyAddress: '',
        county: '',
        titleHolder: '',
        agreementStartDate: '',
        rentalAmount: '',
        possessionDate: '',
        coBrokerCompensationType: 'percentage',
        coBrokerCompensationValue: '',
        additionalCompensation: '',
        referralAgentName: '',
        referralPaymentAmount: '',
        referralPaymentType: '$',
        outsideBrokerage: '',
        foundOutsideBroker: 'yes',
        agentName: 'John Doe',
        agentEmail: 'john.doe@maxhome.ai',
        agentPhone: '(555) 123-4567',
        additionalAgentName: '',
        additionalAgentEmail: '',
        additionalAgentPhone: ''
      });

      const [landlords, setLandlords] = useState([
        { id: 1, name: '', email: '', phone: '' }
      ]);

      const [landlordValidation, setLandlordValidation] = useState({});

      const [hasReferral, setHasReferral] = useState('no');
      const [referralType, setReferralType] = useState('Outside Broker');
      const [bwReferralType, setBwReferralType] = useState('');
      const [prospects, setProspects] = useState([
        { id: 1, firstName: '', lastName: '', address: '' }
      ]);

      const googleAddressOptions = [
        { label: '1234 N Clark St, Chicago, IL 60610', county: 'Cook County' },
        { label: '742 Evergreen Terrace, Springfield, IL 62704', county: 'Sangamon County' },
        { label: '55 E Ontario St, Chicago, IL 60611', county: 'Cook County' },
        { label: '401 N Wabash Ave, Chicago, IL 60611', county: 'Cook County' },
        { label: '233 S Wacker Dr, Chicago, IL 60606', county: 'Cook County' },
        { label: '875 N Michigan Ave, Chicago, IL 60611', county: 'Cook County' },
        { label: '600 E Grand Ave, Chicago, IL 60611', county: 'Cook County' },
        { label: '1060 W Addison St, Chicago, IL 60613', county: 'Cook County' },
        { label: '1 S Wacker Dr, Chicago, IL 60606', county: 'Cook County' },
        { label: '350 N Orleans St, Chicago, IL 60654', county: 'Cook County' }
      ];

      const [showAddressSuggestions, setShowAddressSuggestions] = useState(false);
      const addressDropdownRef = useRef(null);

      const [hasAdditionalAgent, setHasAdditionalAgent] = useState('no');
      const [showAgentDropdown, setShowAgentDropdown] = useState(false);
      const [agentSearchQuery, setAgentSearchQuery] = useState('');
      const [formValidation, setFormValidation] = useState({});

      const [showUploadModal, setShowUploadModal] = useState(false);
      const [selectedFiles, setSelectedFiles] = useState([]);
      const [isDragging, setIsDragging] = useState(false);
      const [currentUploadContext, setCurrentUploadContext] = useState('');
      const [uploadedDocuments, setUploadedDocuments] = useState({
        referral: [],
        listingAgreement: []
      });

      const agentDirectory = [
        { name: 'Michaela White', email: 'michaela.white@example.com', phone: '(312) 555-0101' },
        { name: 'Ethan Ponce', email: 'ethan.ponce@example.com', phone: '(312) 555-0102' },
        { name: 'Louis Diaz', email: 'louis.diaz@example.com', phone: '(312) 555-0103' },
        { name: 'Joe Tyler Gerber', email: 'joe.gerber@example.com', phone: '(312) 555-0104' },
        { name: 'Hinna Khan', email: 'hinna.khan@example.com', phone: '(312) 555-0105' },
        { name: 'Anwar Rana', email: 'anwar.rana@example.com', phone: '(312) 555-0106' },
        { name: 'Marla Manon', email: 'marla.manon@example.com', phone: '(312) 555-0107' },
        { name: 'Anajancy Ponce', email: 'anajancy.ponce@example.com', phone: '(312) 555-0108' }
      ];

      const filteredAgents = agentDirectory.filter(agent =>
        agent.name.toLowerCase().includes(agentSearchQuery.toLowerCase())
      );

      useEffect(() => {
        const handleClickOutside = (event) => {
          if (showAgentDropdown && !event.target.closest('.agent-dropdown-container')) {
            setShowAgentDropdown(false);
          }
        };
        document.addEventListener('mousedown', handleClickOutside);
        return () => document.removeEventListener('mousedown', handleClickOutside);
      }, [showAgentDropdown]);

      useEffect(() => {
        const handleClickOutside = (event) => {
          if (
            showAddressSuggestions &&
            addressDropdownRef.current &&
            !addressDropdownRef.current.contains(event.target)
          ) {
            setShowAddressSuggestions(false);
          }
        };
        document.addEventListener('mousedown', handleClickOutside);
        return () => document.removeEventListener('mousedown', handleClickOutside);
      }, [showAddressSuggestions]);

      const formatPhoneNumber = (value) => {
        const digits = value.replace(/\D/g, '');
        if (digits.length <= 3) return digits;
        if (digits.length <= 6) {
          return `(${digits.slice(0, 3)}) ${digits.slice(3)}`;
        }
        return `(${digits.slice(0, 3)}) ${digits.slice(3, 6)}-${digits.slice(6, 10)}`;
      };

      const validatePhone = (phone) => {
        const digits = phone.replace(/\D/g, '');
        return digits.length === 10;
      };

      const validateEmail = (email) => {
        const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return regex.test(email);
      };

      const handleInputChange = (field, value) => {
        if (field.includes('Phone')) {
          const formatted = formatPhoneNumber(value);
          setFormData(prev => ({ ...prev, [field]: formatted }));
          if (value.length > 0) {
            setFormValidation(prev => ({
              ...prev,
              [field]: validatePhone(formatted) ? null : 'Invalid phone number'
            }));
          } else {
            setFormValidation(prev => ({ ...prev, [field]: null }));
          }
        } else if (field.includes('Email')) {
          setFormData(prev => ({ ...prev, [field]: value }));
          if (value.length > 0) {
            setFormValidation(prev => ({
              ...prev,
              [field]: validateEmail(value) ? null : 'Invalid email address'
            }));
          } else {
            setFormValidation(prev => ({ ...prev, [field]: null }));
          }
        } else {
          setFormData(prev => ({ ...prev, [field]: value }));
        }
      };

      const handleAddressInput = (value) => {
        setFormData(prev => ({ ...prev, propertyAddress: value }));
        setShowAddressSuggestions(true);
      };

      const handleAddressSelect = (option) => {
        setFormData(prev => ({
          ...prev,
          propertyAddress: option.label,
          county: option.county || prev.county
        }));
        setShowAddressSuggestions(false);
      };

      const filteredAddressOptions = googleAddressOptions.filter(option =>
        formData.propertyAddress
          ? option.label.toLowerCase().includes(formData.propertyAddress.toLowerCase())
          : true
      );

      const handleLandlordChange = (landlordId, field, value) => {
        if (field === 'phone') {
          const formatted = formatPhoneNumber(value);
          setLandlords(prev =>
            prev.map(landlord =>
              landlord.id === landlordId ? { ...landlord, [field]: formatted } : landlord
            )
          );
          if (value.length > 0) {
            setLandlordValidation(prev => ({
              ...prev,
              [`${landlordId}-phone`]: validatePhone(formatted) ? null : 'Invalid phone number'
            }));
          } else {
            setLandlordValidation(prev => ({ ...prev, [`${landlordId}-phone`]: null }));
          }
        } else if (field === 'email') {
          setLandlords(prev =>
            prev.map(landlord =>
              landlord.id === landlordId ? { ...landlord, [field]: value } : landlord
            )
          );
          if (value.length > 0) {
            setLandlordValidation(prev => ({
              ...prev,
              [`${landlordId}-email`]: validateEmail(value) ? null : 'Invalid email address'
            }));
          } else {
            setLandlordValidation(prev => ({ ...prev, [`${landlordId}-email`]: null }));
          }
        } else {
          setLandlords(prev =>
            prev.map(landlord =>
              landlord.id === landlordId ? { ...landlord, [field]: value } : landlord
            )
          );
        }
      };

      const handleAddLandlord = () => {
        const newId = landlords.length ? Math.max(...landlords.map(l => l.id)) + 1 : 1;
        setLandlords(prev => [...prev, { id: newId, name: '', email: '', phone: '' }]);
      };

      const handleRemoveLandlord = (landlordId) => {
        if (landlords.length > 1) {
          setLandlords(prev => prev.filter(landlord => landlord.id !== landlordId));
        }
      };

      const handleAddProspect = () => {
        const newId = prospects.length ? Math.max(...prospects.map(p => p.id)) + 1 : 1;
        setProspects(prev => [
          ...prev,
          { id: newId, firstName: '', lastName: '', address: '' }
        ]);
      };

      const handleRemoveProspect = (prospectId) => {
        if (prospects.length > 1) {
          setProspects(prev => prev.filter(p => p.id !== prospectId));
        }
      };

      const handleProspectChange = (prospectId, field, value) => {
        setProspects(prev =>
          prev.map(prospect =>
            prospect.id === prospectId ? { ...prospect, [field]: value } : prospect
          )
        );
      };

      const handleAgentSelect = (agent) => {
        setFormData(prev => ({
          ...prev,
          additionalAgentName: agent.name,
          additionalAgentEmail: agent.email,
          additionalAgentPhone: agent.phone
        }));
        setAgentSearchQuery(agent.name);
        setShowAgentDropdown(false);
        setFormValidation(prev => ({
          ...prev,
          additionalAgentEmail: null,
          additionalAgentPhone: null
        }));
      };

      const handleUploadClick = (context) => {
        setCurrentUploadContext(context);
        setSelectedFiles([]);
        setShowUploadModal(true);
      };

      const handleCloseModal = () => {
        setShowUploadModal(false);
        setSelectedFiles([]);
        setIsDragging(false);
        setCurrentUploadContext('');
      };

      const handleFileSelect = (e) => {
        const files = Array.from(e.target.files);
        setSelectedFiles(prev => [...prev, ...files]);
      };

      const handleDragOver = (e) => {
        e.preventDefault();
        setIsDragging(true);
      };

      const handleDragLeave = (e) => {
        e.preventDefault();
        setIsDragging(false);
      };

      const handleDrop = (e) => {
        e.preventDefault();
        setIsDragging(false);
        const files = Array.from(e.dataTransfer.files);
        setSelectedFiles(prev => [...prev, ...files]);
      };

      const handleRemoveFile = (index) => {
        setSelectedFiles(prev => prev.filter((_, i) => i !== index));
      };

      const handleRemoveUploadedDocument = (context, index) => {
        setUploadedDocuments(prev => ({
          ...prev,
          [context]: prev[context].filter((_, i) => i !== index)
        }));
      };

      const handleUploadSubmit = () => {
        if (selectedFiles.length > 0 && currentUploadContext) {
          setUploadedDocuments(prev => ({
            ...prev,
            [currentUploadContext]: [...prev[currentUploadContext], ...selectedFiles]
          }));
        }
        handleCloseModal();
      };

      const formatFileSize = (bytes) => {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return `${Math.round((bytes / Math.pow(k, i)) * 10) / 10} ${sizes[i]}`;
      };

      const handleSubmit = (e) => {
        e.preventDefault();
        console.log('Listing agreement intake data', {
          formData,
          landlords,
          hasReferral,
          referralType,
          bwReferralType,
          prospects,
          hasAdditionalAgent,
          uploadedDocuments
        });
        alert('Form submitted - data logged to console');
      };

      const handleCancel = () => {
        if (confirm('Are you sure you want to discard the current progress?')) {
          window.location.reload();
        }
      };

      const primaryAgentLabel = "Landlord's agent (1)";
      const secondaryAgentLabel = "Landlord's agent (2)";

      return (
        <div className="max-w-[870px] mx-auto px-4 py-8">
          <form onSubmit={handleSubmit} className="space-y-6">
            {/* Rental listing status */}
            <div className="bg-white rounded-lg shadow-sm p-10">
              <h2 className="text-xl font-bold mb-6">Rental listing status</h2>
              <div>
                <label className="block text-sm mb-3">
                  Do you have a signed rental listing agreement? <span className="text-red-500">*</span>
                </label>
                <div className="space-y-3">
                  <label className="flex items-center">
                    <input
                      type="radio"
                      value="no"
                      checked={formData.listingAgreementStatus === 'no'}
                      onChange={(e) => handleInputChange('listingAgreementStatus', e.target.value)}
                      className="mr-3 w-4 h-4 text-blue-600 focus:ring-blue-500"
                    />
                    <span className="text-sm">No, I need MaxHome AI to generate one</span>
                  </label>
                  <label className="flex items-center">
                    <input
                      type="radio"
                      value="yes"
                      checked={formData.listingAgreementStatus === 'yes'}
                      onChange={(e) => handleInputChange('listingAgreementStatus', e.target.value)}
                      className="mr-3 w-4 h-4 text-blue-600 focus:ring-blue-500"
                    />
                    <span className="text-sm">Yes, I already have a signed agreement</span>
                  </label>
                </div>
                {formData.listingAgreementStatus === 'yes' && (
                  <div className="mt-6">
                    <label className="block text-sm mb-2">
                      Upload your signed rental listing agreement so we can attach it to the file.
                    </label>
                    <button
                      type="button"
                      onClick={() => handleUploadClick('listingAgreement')}
                      className="flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors"
                    >
                      <UploadIcon size={16} />
                      <span>Upload</span>
                    </button>
                    {uploadedDocuments.listingAgreement.length > 0 && (
                      <div className="mt-4 space-y-2">
                        {uploadedDocuments.listingAgreement.map((file, index) => (
                          <div
                            key={`${file.name}-${index}`}
                            className="flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg"
                          >
                            <div className="flex items-center gap-3">
                              <svg
                                className="text-green-600"
                                width="20"
                                height="20"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                strokeWidth="2"
                                strokeLinecap="round"
                                strokeLinejoin="round"
                              >
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                              </svg>
                              <div>
                                <p className="text-sm font-medium text-gray-900">{file.name}</p>
                                <p className="text-xs text-gray-500">({formatFileSize(file.size)})</p>
                              </div>
                            </div>
                            <button
                              type="button"
                              onClick={() => handleRemoveUploadedDocument('listingAgreement', index)}
                              className="text-red-500 hover:text-red-700 transition-colors"
                            >
                              <svg
                                width="16"
                                height="16"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                strokeWidth="2"
                              >
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                              </svg>
                            </button>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>

            {/* Property address */}
            <div className="bg-white rounded-2xl border border-gray-200 p-8">
              <h2 className="text-xl font-semibold text-gray-900 mb-6">Property address</h2>
              <div className="space-y-4">
                <div ref={addressDropdownRef} className="relative">
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Full property address <span className="text-red-500">*</span>
                  </label>
                  <div className="relative">
                    <svg
                      className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      strokeWidth="2"
                    >
                      <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z" />
                      <circle cx="12" cy="10" r="3" />
                    </svg>
                    <input
                      type="text"
                      value={formData.propertyAddress}
                      onChange={(e) => handleAddressInput(e.target.value)}
                      onFocus={() => setShowAddressSuggestions(true)}
                      required
                      placeholder="Search Google Maps"
                      className="w-full pl-12 pr-24 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                    />
                    <span className="absolute right-4 top-1/2 -translate-y-1/2 text-xs font-semibold text-gray-500 uppercase tracking-wide">
                      Google
                    </span>
                  </div>
                  {showAddressSuggestions && (
                    <div className="absolute z-40 w-full mt-2 bg-white border border-gray-200 rounded-xl shadow-lg max-h-64 overflow-y-auto">
                      {filteredAddressOptions.slice(0, 10).map(option => (
                        <button
                          key={option.label}
                          type="button"
                          onClick={() => handleAddressSelect(option)}
                          className="w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors flex items-center gap-3"
                        >
                          <svg
                            width="16"
                            height="16"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            strokeWidth="2"
                            className="text-blue-500 flex-shrink-0"
                          >
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z" />
                            <circle cx="12" cy="10" r="3" />
                          </svg>
                          <div className="flex flex-col">
                            <span className="text-sm text-gray-900">{option.label}</span>
                            {option.county && (
                              <span className="text-xs text-gray-500">{option.county}</span>
                            )}
                          </div>
                        </button>
                      ))}
                      {filteredAddressOptions.length === 0 && (
                        <div className="px-4 py-3 text-sm text-gray-500">
                          Press enter to search the full Google Maps directory.
                        </div>
                      )}
                    </div>
                  )}
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    County <span className="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    value={formData.county}
                    onChange={(e) => handleInputChange('county', e.target.value)}
                    required
                    placeholder="Cook County"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                  />
                </div>
              </div>
            </div>

            {/* Landlord information */}
            <div className="bg-white rounded-2xl border border-gray-200 p-8 space-y-8">
              <h2 className="text-2xl font-semibold text-gray-900">Landlord&apos;s info</h2>

              <div className="space-y-6">
                {landlords.map((landlord, index) => (
                  <div key={landlord.id} className="p-4 border border-gray-200 rounded-xl bg-gray-50">
                    <div className="flex items-center justify-between mb-4">
                      <h3 className="text-sm font-semibold text-gray-700">
                        Landlord {index + 1}
                      </h3>
                      {index > 0 && (
                        <button
                          type="button"
                          onClick={() => handleRemoveLandlord(landlord.id)}
                          className="text-sm text-red-600 hover:text-red-700 transition-colors"
                        >
                          Remove
                        </button>
                      )}
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Landlord name <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="text"
                          value={landlord.name}
                          onChange={(e) => handleLandlordChange(landlord.id, 'name', e.target.value)}
                          required
                          placeholder="Full legal name"
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Landlord email <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="email"
                          value={landlord.email}
                          onChange={(e) => handleLandlordChange(landlord.id, 'email', e.target.value)}
                          required
                          className={`w-full px-4 py-3 border rounded-lg focus:outline-none ${
                            landlordValidation[`${landlord.id}-email`]
                              ? 'border-red-500 focus:border-red-500'
                              : 'border-gray-300 focus:border-blue-500'
                          }`}
                        />
                        {landlordValidation[`${landlord.id}-email`] && (
                          <p className="text-sm text-red-500 mt-1">
                            {landlordValidation[`${landlord.id}-email`]}
                          </p>
                        )}
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Landlord phone <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="tel"
                          value={landlord.phone}
                          onChange={(e) => handleLandlordChange(landlord.id, 'phone', e.target.value)}
                          required
                          placeholder="(555) 555-5555"
                          className={`w-full px-4 py-3 border rounded-lg focus:outline-none ${
                            landlordValidation[`${landlord.id}-phone`]
                              ? 'border-red-500 focus:border-red-500'
                              : 'border-gray-300 focus:border-blue-500'
                          }`}
                        />
                        {landlordValidation[`${landlord.id}-phone`] && (
                          <p className="text-sm text-red-500 mt-1">
                            {landlordValidation[`${landlord.id}-phone`]}
                          </p>
                        )}
                      </div>
                    </div>
                  </div>
                ))}
              </div>

              <button
                type="button"
                onClick={handleAddLandlord}
                className="flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
              >
                <PlusIcon size={16} />
                <span>Add another landlord</span>
              </button>

              <div className="pt-4 border-t border-gray-200">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Title is in the name of (all parties with interest consent)
                </label>
                <input
                  type="text"
                  value={formData.titleHolder}
                  onChange={(e) => handleInputChange('titleHolder', e.target.value)}
                  placeholder="List every party on title"
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                />
              </div>
            </div>

            {/* Representation information */}
            <div className="bg-white rounded-2xl border border-gray-200 p-8">
              <h2 className="text-xl font-semibold text-gray-900 mb-6">Representation information</h2>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Agreement start date <span className="text-red-500">*</span>
                  </label>
                  <input
                    type="date"
                    value={formData.agreementStartDate}
                    onChange={(e) => handleInputChange('agreementStartDate', e.target.value)}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Rental amount
                  </label>
                  <div className="relative">
                    <span className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500">$</span>
                    <input
                      type="number"
                      min="0"
                      value={formData.rentalAmount}
                      onChange={(e) => handleInputChange('rentalAmount', e.target.value)}
                      placeholder="3,200"
                      className="w-full pl-8 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                    />
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Possession date
                  </label>
                  <input
                    type="text"
                    value={formData.possessionDate}
                    onChange={(e) => handleInputChange('possessionDate', e.target.value)}
                    placeholder="ex: Immediately, 30 days after lease, TBD"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                  />
                </div>
              </div>
            </div>

            {/* Compensation terms */}
            <div className="bg-white rounded-2xl border border-gray-200 p-8 space-y-6">
              <div>
                <h2 className="text-xl font-semibold text-gray-900">Compensation terms</h2>
                <p className="mt-2 text-sm text-gray-500">
                  What is the co-broker’s compensation (if applicable)?
                </p>
              </div>

              <div className="space-y-5">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-3">
                    Choose how you want to display compensation
                  </label>
                  <div className="flex flex-col md:flex-row gap-3">
                    <label
                      className={`flex-1 border rounded-xl px-4 py-3 cursor-pointer ${
                        formData.coBrokerCompensationType === 'percentage'
                          ? 'border-blue-500 bg-blue-50'
                          : 'border-gray-200 bg-white'
                      }`}
                    >
                      <div className="flex items-center gap-3">
                        <input
                          type="radio"
                          value="percentage"
                          checked={formData.coBrokerCompensationType === 'percentage'}
                          onChange={(e) => handleInputChange('coBrokerCompensationType', e.target.value)}
                          className="w-4 h-4 text-blue-600 focus:ring-blue-500"
                        />
                        <div>
                          <p className="text-sm font-semibold text-gray-900">% of one month’s rent</p>
                          <p className="text-xs text-gray-500">Most common choice</p>
                        </div>
                      </div>
                    </label>
                    <label
                      className={`flex-1 border rounded-xl px-4 py-3 cursor-pointer ${
                        formData.coBrokerCompensationType === 'fixed'
                          ? 'border-blue-500 bg-blue-50'
                          : 'border-gray-200 bg-white'
                      }`}
                    >
                      <div className="flex items-center gap-3">
                        <input
                          type="radio"
                          value="fixed"
                          checked={formData.coBrokerCompensationType === 'fixed'}
                          onChange={(e) => handleInputChange('coBrokerCompensationType', e.target.value)}
                          className="w-4 h-4 text-blue-600 focus:ring-blue-500"
                        />
                        <div>
                          <p className="text-sm font-semibold text-gray-900">Fixed compensation</p>
                          <p className="text-xs text-gray-500">Flat payout regardless of rent</p>
                        </div>
                      </div>
                    </label>
                  </div>
                </div>

                {formData.coBrokerCompensationType === 'percentage' && (
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Exact percentage of one month’s rent <span className="text-red-500">*</span>
                    </label>
                    <div className="relative">
                      <input
                        type="number"
                        min="0"
                        max="100"
                        step="0.1"
                        value={formData.coBrokerCompensationValue}
                        onChange={(e) => handleInputChange('coBrokerCompensationValue', e.target.value)}
                        required
                        placeholder="50"
                        className="w-full pr-12 pl-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                      />
                      <span className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500">%</span>
                    </div>
                  </div>
                )}

                {formData.coBrokerCompensationType === 'fixed' && (
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Fixed compensation amount <span className="text-red-500">*</span>
                    </label>
                    <div className="relative">
                      <span className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500">$</span>
                      <input
                        type="number"
                        min="0"
                        value={formData.coBrokerCompensationValue}
                        onChange={(e) => handleInputChange('coBrokerCompensationValue', e.target.value)}
                        required
                        placeholder="1600"
                        className="w-full pl-8 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                      />
                    </div>
                  </div>
                )}

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Additional compensation (if any)
                  </label>
                  <textarea
                    value={formData.additionalCompensation}
                    onChange={(e) => handleInputChange('additionalCompensation', e.target.value)}
                    rows={3}
                    placeholder="Describe any bonuses or conditional payouts."
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                  ></textarea>
                </div>

                <div className="bg-gray-50 p-4 rounded-lg">
                  <p className="text-sm font-medium text-gray-900">Tenant flat fee: $50</p>
                  <p className="text-sm text-gray-500">
                    We automatically display this fee alongside your co-broker compensation.
                  </p>
                </div>
              </div>
            </div>

            {/* Referral information */}
            <div className="bg-white rounded-2xl border border-gray-200 p-8">
              <h2 className="text-xl font-semibold mb-6">Referral information</h2>
              <div className="space-y-4">
                <div>
                  <label className="block text-sm mb-3">Is there a referral?</label>
                  <div className="flex gap-6">
                    <label className="flex items-center">
                      <input
                        type="radio"
                        value="no"
                        checked={hasReferral === 'no'}
                        onChange={(e) => setHasReferral(e.target.value)}
                        className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                      />
                      <span className="text-sm">No</span>
                    </label>
                    <label className="flex items-center">
                      <input
                        type="radio"
                        value="yes"
                        checked={hasReferral === 'yes'}
                        onChange={(e) => setHasReferral(e.target.value)}
                        className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                      />
                      <span className="text-sm">Yes</span>
                    </label>
                  </div>
                </div>

                {hasReferral === 'yes' && (
                  <div className="space-y-4 pt-4">
                    <div>
                      <label className="block text-sm mb-2">
                        What type of referral? <span className="text-red-500">*</span>
                      </label>
                      <div className="relative">
                        <select
                          value={referralType}
                          onChange={(e) => {
                            const nextType = e.target.value;
                            setReferralType(nextType);
                            setFormData(prev => ({
                              ...prev,
                              referralAgentName: '',
                              referralPaymentAmount: '',
                              referralPaymentType: '',
                              outsideBrokerage: '',
                              foundOutsideBroker: 'yes'
                            }));
                            setBwReferralType('');
                          }}
                          required={hasReferral === 'yes'}
                          className="w-full pl-4 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 appearance-none bg-white"
                        >
                          <option value="Outside Broker">Outside Broker</option>
                          <option value="Intra Office">Intra Office</option>
                          <option value="B&W Referral">B&W Referral</option>
                        </select>
                        <svg
                          className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400"
                          width="20"
                          height="20"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          strokeWidth="2"
                        >
                          <polyline points="6 9 12 15 18 9" />
                        </svg>
                      </div>
                    </div>

                    {referralType === 'Outside Broker' && (
                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm mb-2">
                            Agent name <span className="text-red-500">*</span>
                          </label>
                          <input
                            type="text"
                            value={formData.referralAgentName}
                            onChange={(e) => handleInputChange('referralAgentName', e.target.value)}
                            required
                            placeholder="Enter agent name"
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                          />
                        </div>
                        <div>
                          <label className="block text-sm mb-2">
                            Referral fee structure <span className="text-red-500">*</span>
                          </label>
                          <div className="flex gap-4">
                            <label className="flex items-center">
                              <input
                                type="radio"
                                value="$"
                                checked={formData.referralPaymentType === '$'}
                                onChange={(e) => handleInputChange('referralPaymentType', e.target.value)}
                                required
                                className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                              />
                              <span className="text-sm">Fixed amount ($)</span>
                            </label>
                            <label className="flex items-center">
                              <input
                                type="radio"
                                value="%"
                                checked={formData.referralPaymentType === '%'}
                                onChange={(e) => handleInputChange('referralPaymentType', e.target.value)}
                                required
                                className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                              />
                              <span className="text-sm">Percentage (%)</span>
                            </label>
                          </div>
                        </div>
                        {formData.referralPaymentType && (
                          <div>
                            <label className="block text-sm mb-2">
                              Referral fee amount <span className="text-red-500">*</span>
                            </label>
                            <input
                              type="text"
                              value={formData.referralPaymentAmount}
                              onChange={(e) => handleInputChange('referralPaymentAmount', e.target.value)}
                              required
                              placeholder={
                                formData.referralPaymentType === '$'
                                  ? 'Enter dollar amount'
                                  : 'Enter percentage'
                              }
                              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                            />
                          </div>
                        )}
                        <div>
                          <label className="block text-sm mb-2">Supporting documents</label>
                          <div className="bg-gray-50 p-6 rounded-lg border border-dashed border-gray-300">
                            <p className="text-sm mb-3">
                              Please upload supporting documents for Outside brokerage referral agreements.
                            </p>
                            <button
                              type="button"
                              onClick={() => handleUploadClick('referral')}
                              className="flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors"
                            >
                              <UploadIcon size={16} />
                              <span>Upload</span>
                            </button>
                            <p className="text-sm text-gray-500 mt-3">
                              We will add an empty template if you do not upload one.
                            </p>
                            {uploadedDocuments.referral.length > 0 && (
                              <div className="mt-4 space-y-2">
                                {uploadedDocuments.referral.map((file, index) => (
                                  <div
                                    key={`${file.name}-${index}`}
                                    className="flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg"
                                  >
                                    <div className="flex items-center gap-3">
                                      <svg
                                        className="text-blue-500"
                                        width="20"
                                        height="20"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        stroke="currentColor"
                                        strokeWidth="2"
                                      >
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                        <polyline points="14 2 14 8 20 8"></polyline>
                                      </svg>
                                      <div>
                                        <p className="text-sm font-medium text-gray-900">{file.name}</p>
                                        <p className="text-xs text-gray-500">{formatFileSize(file.size)}</p>
                                      </div>
                                    </div>
                                    <button
                                      type="button"
                                      onClick={() => handleRemoveUploadedDocument('referral', index)}
                                      className="text-red-500 hover:text-red-700"
                                    >
                                      <svg
                                        width="16"
                                        height="16"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        stroke="currentColor"
                                        strokeWidth="2"
                                      >
                                        <line x1="18" y1="6" x2="6" y2="18"></line>
                                        <line x1="6" y1="6" x2="18" y2="18"></line>
                                      </svg>
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>
                        <div>
                          <label className="block text-sm mb-2">Outside brokerage</label>
                          <div className="relative">
                            <select
                              value={formData.outsideBrokerage}
                              onChange={(e) => handleInputChange('outsideBrokerage', e.target.value)}
                              className="w-full pl-4 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 appearance-none bg-white"
                            >
                              <option value="">--- Select a value ---</option>
                              <option value="Brokerage 1">Brokerage 1</option>
                              <option value="Brokerage 2">Brokerage 2</option>
                              <option value="Brokerage 3">Brokerage 3</option>
                            </select>
                            <svg
                              className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400"
                              width="20"
                              height="20"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              strokeWidth="2"
                            >
                              <polyline points="6 9 12 15 18 9" />
                            </svg>
                          </div>
                        </div>
                        <div>
                          <label className="block text-sm mb-3">
                            Did you find the outside broker above? <span className="text-red-500">*</span>
                          </label>
                          <div className="flex gap-6">
                            <label className="flex items-center">
                              <input
                                type="radio"
                                value="yes"
                                checked={formData.foundOutsideBroker === 'yes'}
                                onChange={(e) => handleInputChange('foundOutsideBroker', e.target.value)}
                                required
                                className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                              />
                              <span className="text-sm">Yes</span>
                            </label>
                            <label className="flex items-center">
                              <input
                                type="radio"
                                value="no"
                                checked={formData.foundOutsideBroker === 'no'}
                                onChange={(e) => handleInputChange('foundOutsideBroker', e.target.value)}
                                required
                                className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                              />
                              <span className="text-sm">No</span>
                            </label>
                          </div>
                          {formData.foundOutsideBroker === 'no' && (
                            <div className="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                              <p className="text-sm text-yellow-800 font-medium mb-2">
                                Form cannot be submitted until the W9 document is attached.
                              </p>
                              <button
                                type="button"
                                onClick={() => handleUploadClick('referral')}
                                className="flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors"
                              >
                                <UploadIcon size={16} />
                                <span>Upload W9</span>
                              </button>
                            </div>
                          )}
                        </div>
                      </div>
                    )}

                    {referralType === 'Intra Office' && (
                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm mb-2">
                            Agent name <span className="text-red-500">*</span>
                          </label>
                          <div className="relative">
                            <select
                              value={formData.referralAgentName}
                              onChange={(e) => handleInputChange('referralAgentName', e.target.value)}
                              required
                              className="w-full pl-4 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 appearance-none bg-white"
                            >
                              <option value="">Search for an agent...</option>
                              {agentDirectory.map(agent => (
                                <option key={agent.email} value={agent.name}>
                                  {agent.name}
                                </option>
                              ))}
                            </select>
                            <svg
                              className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400"
                              width="20"
                              height="20"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              strokeWidth="2"
                            >
                              <polyline points="6 9 12 15 18 9" />
                            </svg>
                          </div>
                        </div>
                        <div>
                          <label className="block text-sm mb-2">
                            Referral fee structure <span className="text-red-500">*</span>
                          </label>
                          <div className="flex gap-4">
                            <label className="flex items-center">
                              <input
                                type="radio"
                                value="$"
                                checked={formData.referralPaymentType === '$'}
                                onChange={(e) => handleInputChange('referralPaymentType', e.target.value)}
                                required
                                className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                              />
                              <span className="text-sm">Fixed amount ($)</span>
                            </label>
                            <label className="flex items-center">
                              <input
                                type="radio"
                                value="%"
                                checked={formData.referralPaymentType === '%'}
                                onChange={(e) => handleInputChange('referralPaymentType', e.target.value)}
                                required
                                className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                              />
                              <span className="text-sm">Percentage (%)</span>
                            </label>
                          </div>
                        </div>
                        {formData.referralPaymentType && (
                          <div>
                            <label className="block text-sm mb-2">
                              Referral fee amount <span className="text-red-500">*</span>
                            </label>
                            <input
                              type="text"
                              value={formData.referralPaymentAmount}
                              onChange={(e) => handleInputChange('referralPaymentAmount', e.target.value)}
                              required
                              placeholder={
                                formData.referralPaymentType === '$'
                                  ? 'Enter dollar amount'
                                  : 'Enter percentage'
                              }
                              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                            />
                          </div>
                        )}
                        <div className="bg-gray-50 p-6 rounded-lg border border-dashed border-gray-300">
                          <p className="text-sm mb-3">
                            Please add supporting documents for the referral agreement.
                          </p>
                          <button
                            type="button"
                            onClick={() => handleUploadClick('referral')}
                            className="flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors"
                          >
                            <UploadIcon size={16} />
                            <span>Upload</span>
                          </button>
                        </div>
                      </div>
                    )}

                    {referralType === 'B&W Referral' && (
                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm mb-3">
                            B&amp;W referral? <span className="text-red-500">*</span>
                          </label>
                          <div className="space-y-3">
                            {[
                              'BW EBiz (Zillow, Op City, etc)',
                              'BW PPN Referral',
                              'BW Relocation'
                            ].map(option => (
                              <label key={option} className="flex items-center">
                                <input
                                  type="radio"
                                  value={option}
                                  checked={bwReferralType === option}
                                  onChange={(e) => setBwReferralType(e.target.value)}
                                  required
                                  className="mr-3 w-4 h-4 text-blue-600 focus:ring-blue-500"
                                />
                                <span className="text-sm">{option}</span>
                              </label>
                            ))}
                          </div>
                        </div>

                        {(bwReferralType === 'BW PPN Referral' || bwReferralType === 'BW Relocation') && (
                          <div>
                            <h3 className="text-lg font-semibold mb-4">Prospect</h3>
                            {prospects.map((prospect, index) => (
                              <div
                                key={prospect.id}
                                className={index > 0 ? 'pt-6 mt-6 border-t border-gray-200' : ''}
                              >
                                <div className="flex items-center justify-between mb-4">
                                  <h4 className="text-sm font-semibold text-gray-700">
                                    Prospect {index + 1}
                                  </h4>
                                  {index > 0 && (
                                    <button
                                      type="button"
                                      onClick={() => handleRemoveProspect(prospect.id)}
                                      className="text-sm text-red-600 hover:text-red-700"
                                    >
                                      Remove
                                    </button>
                                  )}
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                  <div>
                                    <label className="block text-sm mb-2">
                                      Prospect first name <span className="text-red-500">*</span>
                                    </label>
                                    <input
                                      type="text"
                                      value={prospect.firstName}
                                      onChange={(e) => handleProspectChange(prospect.id, 'firstName', e.target.value)}
                                      required
                                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                                    />
                                  </div>
                                  <div>
                                    <label className="block text-sm mb-2">
                                      Prospect last name <span className="text-red-500">*</span>
                                    </label>
                                    <input
                                      type="text"
                                      value={prospect.lastName}
                                      onChange={(e) => handleProspectChange(prospect.id, 'lastName', e.target.value)}
                                      required
                                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                                    />
                                  </div>
                                  <div>
                                    <label className="block text-sm mb-2">Address</label>
                                    <input
                                      type="text"
                                      value={prospect.address}
                                      onChange={(e) => handleProspectChange(prospect.id, 'address', e.target.value)}
                                      placeholder="Optional"
                                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                                    />
                                  </div>
                                </div>
                              </div>
                            ))}
                            <button
                              type="button"
                              onClick={handleAddProspect}
                              className="mt-6 flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
                            >
                              <PlusIcon size={16} />
                              <span>Add prospect</span>
                            </button>
                          </div>
                        )}
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>

            {/* Agent details */}
            <div className="bg-white rounded-2xl border border-gray-200 p-8">
              <h2 className="text-xl font-semibold mb-6">Landlord&apos;s agent details</h2>
              <div className="space-y-4">
                <div>
                  <label className="block text-sm mb-2">
                    {primaryAgentLabel} name <span className="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    value={formData.agentName}
                    onChange={(e) => handleInputChange('agentName', e.target.value)}
                    required
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                  />
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm mb-2">
                      {primaryAgentLabel} email <span className="text-red-500">*</span>
                    </label>
                    <input
                      type="email"
                      value={formData.agentEmail}
                      onChange={(e) => handleInputChange('agentEmail', e.target.value)}
                      required
                      className={`w-full px-4 py-2 border rounded-lg focus:outline-none ${
                        formValidation.agentEmail
                          ? 'border-red-500 focus:border-red-500'
                          : 'border-gray-300 focus:border-blue-500'
                      }`}
                    />
                    {formValidation.agentEmail && (
                      <p className="text-sm text-red-500 mt-1">{formValidation.agentEmail}</p>
                    )}
                  </div>
                  <div>
                    <label className="block text-sm mb-2">
                      {primaryAgentLabel} phone <span className="text-red-500">*</span>
                    </label>
                    <input
                      type="tel"
                      value={formData.agentPhone}
                      onChange={(e) => handleInputChange('agentPhone', e.target.value)}
                      required
                      placeholder="(555) 555-5555"
                      className={`w-full px-4 py-2 border rounded-lg focus:outline-none ${
                        formValidation.agentPhone
                          ? 'border-red-500 focus:border-red-500'
                          : 'border-gray-300 focus:border-blue-500'
                      }`}
                    />
                    {formValidation.agentPhone && (
                      <p className="text-sm text-red-500 mt-1">{formValidation.agentPhone}</p>
                    )}
                  </div>
                </div>

                <div>
                  <label className="block text-sm mb-3">Add a second landlord&apos;s agent?</label>
                  <div className="flex gap-6">
                    <label className="flex items-center">
                      <input
                        type="radio"
                        value="no"
                        checked={hasAdditionalAgent === 'no'}
                        onChange={(e) => setHasAdditionalAgent(e.target.value)}
                        className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                      />
                      <span className="text-sm">No</span>
                    </label>
                    <label className="flex items-center">
                      <input
                        type="radio"
                        value="yes"
                        checked={hasAdditionalAgent === 'yes'}
                        onChange={(e) => setHasAdditionalAgent(e.target.value)}
                        className="mr-2 w-4 h-4 text-blue-600 focus:ring-blue-500"
                      />
                      <span className="text-sm">Yes</span>
                    </label>
                  </div>
                </div>

                {hasAdditionalAgent === 'yes' && (
                  <div className="space-y-4 pt-4">
                    <div className="relative agent-dropdown-container">
                      <label className="block text-sm mb-2">
                        {secondaryAgentLabel} name <span className="text-red-500">*</span>
                      </label>
                      <div className="relative">
                        <input
                          type="text"
                          value={agentSearchQuery}
                          onChange={(e) => {
                            setAgentSearchQuery(e.target.value);
                            setFormData(prev => ({ ...prev, additionalAgentName: e.target.value }));
                            setShowAgentDropdown(true);
                          }}
                          onFocus={() => setShowAgentDropdown(true)}
                          placeholder="Search for an agent..."
                          required
                          className="w-full px-4 py-2 pr-10 border border-blue-500 rounded-lg focus:outline-none focus:border-blue-500"
                        />
                        <svg
                          className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"
                          width="20"
                          height="20"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          strokeWidth="2"
                        >
                          <circle cx="11" cy="11" r="8"></circle>
                          <path d="m21 21-4.35-4.35"></path>
                        </svg>

                        {showAgentDropdown && (
                          <div className="absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto">
                            {filteredAgents.length > 0 ? (
                              filteredAgents.map((agent, index) => (
                                <button
                                  key={agent.email}
                                  type="button"
                                  onClick={() => handleAgentSelect(agent)}
                                  className="w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-b-0"
                                >
                                  <p className="text-sm font-medium text-gray-900">{agent.name}</p>
                                  <p className="text-xs text-gray-500">{agent.email}</p>
                                </button>
                              ))
                            ) : (
                              <div className="px-4 py-3 text-sm text-gray-500">No agents found</div>
                            )}
                          </div>
                        )}
                      </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm mb-2">
                          {secondaryAgentLabel} email <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="email"
                          value={formData.additionalAgentEmail}
                          onChange={(e) => handleInputChange('additionalAgentEmail', e.target.value)}
                          required
                          className={`w-full px-4 py-2 border rounded-lg focus:outline-none ${
                            formValidation.additionalAgentEmail
                              ? 'border-red-500 focus:border-red-500'
                              : 'border-gray-300 focus:border-blue-500'
                          }`}
                        />
                        {formValidation.additionalAgentEmail && (
                          <p className="text-sm text-red-500 mt-1">
                            {formValidation.additionalAgentEmail}
                          </p>
                        )}
                      </div>
                      <div>
                        <label className="block text-sm mb-2">
                          {secondaryAgentLabel} phone <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="tel"
                          value={formData.additionalAgentPhone}
                          onChange={(e) => handleInputChange('additionalAgentPhone', e.target.value)}
                          required
                          placeholder="(555) 555-5555"
                          className={`w-full px-4 py-2 border rounded-lg focus:outline-none ${
                            formValidation.additionalAgentPhone
                              ? 'border-red-500 focus:border-red-500'
                              : 'border-gray-300 focus:border-blue-500'
                          }`}
                        />
                        {formValidation.additionalAgentPhone && (
                          <p className="text-sm text-red-500 mt-1">
                            {formValidation.additionalAgentPhone}
                          </p>
                        )}
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>

            <div className="flex justify-end gap-4 pt-4 pb-10">
              <button
                type="button"
                onClick={handleCancel}
                className="px-6 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
              >
                Cancel
              </button>
              <button
                type="submit"
                className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
              >
                Submit
              </button>
            </div>
          </form>

          {showUploadModal && (
            <>
              <div
                className="fixed bg-black bg-opacity-50"
                style={{ top: 0, left: 0, right: 0, bottom: 0, zIndex: 60 }}
                onClick={handleCloseModal}
              ></div>

              <div
                className="fixed flex items-center justify-center p-4"
                style={{ top: 0, left: 0, right: 0, bottom: 0, zIndex: 70 }}
              >
                <div className="bg-white rounded-lg shadow-xl max-w-2xl w-full">
                  <div className="flex items-center justify-between p-6 border-b border-gray-200">
                    <h2 className="text-xl font-semibold text-gray-900">Upload documents</h2>
                    <button
                      onClick={handleCloseModal}
                      className="text-gray-400 hover:text-gray-600 transition-colors"
                    >
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        strokeWidth="2"
                      >
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                      </svg>
                    </button>
                  </div>

                  <div className="p-6">
                    <p className="text-sm text-gray-600 mb-6">
                      <span className="text-blue-600 font-medium">MaxHome AI</span> will automatically
                      extract, organize, and label documents from your upload while keeping originals for reference.
                    </p>

                    <div
                      onDragOver={handleDragOver}
                      onDragLeave={handleDragLeave}
                      onDrop={handleDrop}
                      className={`border-2 border-dashed rounded-lg p-12 text-center transition-colors ${
                        isDragging ? 'border-blue-500 bg-blue-50' : 'border-gray-300 bg-gray-50'
                      }`}
                    >
                      <div className="flex justify-center mb-4">
                        <UploadIcon size={48} />
                      </div>
                      <p className="text-lg font-medium text-gray-900 mb-2">
                        Drag and drop your files here!
                      </p>
                      <p className="text-sm text-gray-500 mb-4">Maximum file size: 100MB</p>
                      <label className="inline-block cursor-pointer">
                        <input
                          type="file"
                          multiple
                          onChange={handleFileSelect}
                          className="hidden"
                          accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                        />
                        <span className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors inline-block">
                          Browse files
                        </span>
                      </label>
                    </div>

                    {selectedFiles.length > 0 && (
                      <div className="mt-6">
                        <h3 className="text-sm font-medium text-gray-900 mb-3">
                          Selected files ({selectedFiles.length})
                        </h3>
                        <div className="space-y-2 max-h-48 overflow-y-auto">
                          {selectedFiles.map((file, index) => (
                            <div
                              key={`${file.name}-${index}`}
                              className="flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200"
                            >
                              <div className="flex items-center gap-3">
                                <svg
                                  width="20"
                                  height="20"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  stroke="currentColor"
                                  strokeWidth="2"
                                  className="text-gray-400"
                                >
                                  <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                                  <polyline points="13 2 13 9 20 9"></polyline>
                                </svg>
                                <div>
                                  <p className="text-sm font-medium text-gray-900">{file.name}</p>
                                  <p className="text-xs text-gray-500">{formatFileSize(file.size)}</p>
                                </div>
                              </div>
                              <button
                                type="button"
                                onClick={() => handleRemoveFile(index)}
                                className="text-gray-400 hover:text-red-600 transition-colors"
                              >
                                <svg
                                  width="16"
                                  height="16"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  stroke="currentColor"
                                  strokeWidth="2"
                                >
                                  <line x1="18" y1="6" x2="6" y2="18"></line>
                                  <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                              </button>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}
                  </div>

                  <div className="flex justify-end gap-3 p-6 border-t border-gray-200">
                    <button
                      type="button"
                      onClick={handleCloseModal}
                      className="px-6 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                    >
                      Cancel
                    </button>
                    <button
                      type="button"
                      onClick={handleUploadSubmit}
                      disabled={selectedFiles.length === 0}
                      className={`px-6 py-2 rounded-lg transition-colors ${
                        selectedFiles.length === 0
                          ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                          : 'bg-blue-600 text-white hover:bg-blue-700'
                      }`}
                    >
                      Submit
                    </button>
                  </div>
                </div>
              </div>
            </>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
